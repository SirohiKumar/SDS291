---
title: "SDS 291 - STAT2 R Companion Chapter 1: Simple Linear Regression"
output:
  html_document:
    df_print: paged
---

## Section 1.1: The Simple Linear Regression Model (01-30-24)

#### load libraries
```{r message=FALSE}

library(ggplot2)
library(Stat2Data)
library(broom)
library(dplyr)
library(equatiomatic) ##remotes::install_github("datalorax/equatiomatic")

```

#### load the data
```{r}

data("AccordPrice")
head(AccordPrice)

```

#### preliminary visualization
```{r}

plot = ggplot(AccordPrice, mapping = aes(x = Mileage, y = Price)) + 
  geom_point(color="#92278f") + ## using the colors from the STAT2 textbook
  theme_bw() 

plot

```

#### fitting a simple linear regression model

given the ~ implies a linear model formula: y ~ x
```{r}

price_model = lm(Price ~ Mileage, AccordPrice) 
# summary(price_model)

```

extract just the coefficient values: 
```{r}

coef(price_model)

```

this anova's p-value indicates the variance between car price is significant
```{r}

anova(price_model)

```

#### adding the regression line to the scatter plot

geom smooth is a generic smoothing function. the method argument tells it to display the linear model on the plot. 
```{r warning=FALSE}

plot = plot + geom_smooth(method = lm, se = FALSE, forumla = y ~ x)

plot

```

#### examine the residuals

returns a vector with an element for each row of the dataset
```{r}

residuals(price_model)

```

however, this vector is missing the predicted output values generated by `price_model`. the predicted values are in the .fitted columns and the residuals in the .resid column. 
```{r}

augment(price_model)

```

#### centering the explanatory variable

use the `dplyr` package's `mutate` function to generate a new column with centered Mileage values. 
```{r}

AccordPrice = AccordPrice %>%
  mutate(cMileage = Mileage - 50)

head(AccordPrice)

```

we can now recreate the model with the centered values using `lm()` again. 
```{r}

centered_model = lm(Price ~ cMileage, AccordPrice)
coef(centered_model)

```

display the model looking fancy
```{r}

extract_eq(centered_model, use_coefs = TRUE)

```









